---
layout: post
title: "SPI, I2C, UART là gì? Chúng khác nhau ở điểm nào?"
date: 2025-10-11
tags: [theoritical, protocol]
---

Trong hệ thống nhúng, việc trao đổi thông tin giữa các module (giữa chip với chip, giữa board với board) trong một hệ thống lớn là điều bắt buộc. Một module khó có thể thực hiện tất cả các công việc của hệ thống. Ví dụ như trong máy giặt, có thể có một board đảm nhiệm quá trình giặt (xoay lồng giặt, tách chiết nước giặt, xả nước, ...), một board xử lý việc người dùng thay đổi thông số giặt bằng các nút nhấn, một board đảm nhận việc đọc ghi các thông tin vào ROM, ...

Việc truyền nhận dữ liệu này thường được thực hiện tuân theo một chuẩn giao thức nhất định. Giao thức định nghĩa cấu trúc của gói tin truyền nhận, cách kết nối giữa các module về mặt vật lý, hoặc nâng cao hơn là cách thức phát hiện và sửa lỗi trong quá trình truyền nhận.

SPI, I2C, UART là 3 giao thức cơ bản, được sử dụng trong các hệ thống nhúng. Vậy cụ thể các giao thức này là gì và chúng khác gì nhau, cùng tớ khám phá từng giao thức một nhé!
  
## 1. UART
UART (Universal asynchronous receiver-transmitteer) là giao thức phổ biến nhất, sử dụng 2 sợi dây để truyền nhận thông tin giữa 2 thiết bị:
![UART](/assets/images/image.png)

Dữ liệu sẽ được gửi tuần tự (các bit được gửi lần lượt) và bất đồng bộ (không sử dụng tín hiệu clock để kiểm soát thời gian truyền nhận data).

Nếu như không sử dụng tín hiệu clock, dữ liệu được truyền nhận như thế nào? UART giải quyết vấn đề này bằng cách định nghĩa cấu trúc của một gói tin như sau:
![Gói tin UART](/assets/images/image-1.png)
- **Start bit**: được thiết bị gửi truyền đi khi muốn bắt đầu gửi data. Trạng thái idle của data (chưa gửi thông tin) là HIGH (bit 1), do vậy **start bit** có thể được nhận diện khi data nhận được chuyển từ HIGH sang LOW.
- **Data bits**: là dữ liệu thực sự cần truyền đi (payload), thường là 8 bits nhưng có thể được config thành 7 hoặc 6 bits tùy trường hợp (việc config này phải đảm bảo giống nhau giữa 2 thiết bị).
- **Parity bit**: dùng để xác định lỗi xảy ra trong quá trình truyền nhận data. Ví dụ, nếu tuân theo parity bit chẵn, **parity bit** bằng 1 khi số bit 1 trong data bits là số chẵn, và bằng 0 khi số bit 1 trong data bits là số lẻ. Thiết bị nhận có thể đối chiếu **parity bit** và số bit 1 trong data bits trong gói tin nhận được để phát hiện lỗi.
- **Stop bits**: tùy theo từng cấu hình, có thể là 1 hoặc 2 bit để đưa tín hiệu đã truyền xong dữ liệu.

Như vậy, có thể sử dụng cấu trúc của gói tin để thiết bị nhận xác định được khi nào có gói tin UART truyền tới nó, và đọc các data trong gói tin nhận được. Tuy nhiên, trên đường truyền dữ liệu không được truyền ngay lập tức mà sẽ có độ trễ, vì vậy dữ liệu nhận được tại thiết bị nhận có thể bị lệch về thời gian so với dữ liệu truyền đi tại từ thiết bị truyền. Và độ trễ này có thể khiến cho thiết bị nhận xử lý sai dữ liệu nếu phải gửi đi với tốc độ quá nhanh, do vậy UART không thể hỗ trợ truyền nhận với tốc độ quá cao, và cũng chỉ hỗ trợ một số tốc độ truyền nhất định đã được nghiên cứu để giảm thiểu ảnh hưởng của độ trễ này (9600, 19200, 38400, 57600, và 115200).

## 2. SPI
Trái với UART, SPI (Serial Peripheral Interface) là một giao thức đồng bộ, sử dụng tín hiệu clock để đồng bộ dữ liệu truyền đi giữa các thiết bị
## 3. I2C


